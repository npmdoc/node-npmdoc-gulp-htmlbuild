<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="https://github.com/Janpot/gulp-htmlbuild"

    >gulp-htmlbuild (v0.4.2)</a>
</h1>
<h4>Extract content from html documents and replace by build result</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.gulp-htmlbuild">module gulp-htmlbuild</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.gulp-htmlbuild.gulp-htmlbuild">
            function <span class="apidocSignatureSpan"></span>gulp-htmlbuild
            <span class="apidocSignatureSpan">(config)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">gulp-htmlbuild.</span>builder</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">gulp-htmlbuild.</span>parser</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">gulp-htmlbuild.</span>preprocess</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.gulp-htmlbuild.builder">module gulp-htmlbuild.builder</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.gulp-htmlbuild.builder.build">
            function <span class="apidocSignatureSpan">gulp-htmlbuild.builder.</span>build
            <span class="apidocSignatureSpan">(config)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.gulp-htmlbuild.parser">module gulp-htmlbuild.parser</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.gulp-htmlbuild.parser._tokenize">
            function <span class="apidocSignatureSpan">gulp-htmlbuild.parser.</span>_tokenize
            <span class="apidocSignatureSpan">(line)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.gulp-htmlbuild.parser.parse">
            function <span class="apidocSignatureSpan">gulp-htmlbuild.parser.</span>parse
            <span class="apidocSignatureSpan">(file)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">gulp-htmlbuild.parser.</span>_tokens</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.gulp-htmlbuild.preprocess">module gulp-htmlbuild.preprocess</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.gulp-htmlbuild.preprocess.css">
            function <span class="apidocSignatureSpan">gulp-htmlbuild.preprocess.</span>css
            <span class="apidocSignatureSpan">(buildFn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.gulp-htmlbuild.preprocess.js">
            function <span class="apidocSignatureSpan">gulp-htmlbuild.preprocess.</span>js
            <span class="apidocSignatureSpan">(buildFn)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.gulp-htmlbuild" id="apidoc.module.gulp-htmlbuild">module gulp-htmlbuild</a></h1>


    <h2>
        <a href="#apidoc.element.gulp-htmlbuild.gulp-htmlbuild" id="apidoc.element.gulp-htmlbuild.gulp-htmlbuild">
        function <span class="apidocSignatureSpan"></span>gulp-htmlbuild
        <span class="apidocSignatureSpan">(config)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">gulp-htmlbuild = function (config) {

  function htmlbuildFile(file, callback) {

    if (file.isNull()) {
      return callback(null, file); // pass along
    }

    if (file.isStream()) {
      return callback(new PluginError(PLUGIN_NAME, &#x27;Streaming not supported&#x27;, {
        fileName: file.path
      }));
    }

    parser.parse(file)
      .pipe(builder.build(config))
      .pipe(es.wait(function (error, content) {
        file.contents = new Buffer(content);
        callback(error, file);
      }));
  }

  return es.map(htmlbuildFile);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>








</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.gulp-htmlbuild.builder" id="apidoc.module.gulp-htmlbuild.builder">module gulp-htmlbuild.builder</a></h1>


    <h2>
        <a href="#apidoc.element.gulp-htmlbuild.builder.build" id="apidoc.element.gulp-htmlbuild.builder.build">
        function <span class="apidocSignatureSpan">gulp-htmlbuild.builder.</span>build
        <span class="apidocSignatureSpan">(config)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function build(config) {
  config = config || {};

  var buildStream = es.through(function write(block) {
    var buildFn = block.target &#x26;&#x26; config[block.target],
        blockStream = new BlockStream(block);

    if (buildFn) {
      buildFn(blockStream);
    } else {
      blockStream.pipe(blockStream);
    }

    this.queue(blockStream.result);
  });

  return es.pipeline(
    buildStream,
    flatten(),
    es.join(&#x27;\n&#x27;)
  );
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.gulp-htmlbuild.parser" id="apidoc.module.gulp-htmlbuild.parser">module gulp-htmlbuild.parser</a></h1>


    <h2>
        <a href="#apidoc.element.gulp-htmlbuild.parser._tokenize" id="apidoc.element.gulp-htmlbuild.parser._tokenize">
        function <span class="apidocSignatureSpan">gulp-htmlbuild.parser.</span>_tokenize
        <span class="apidocSignatureSpan">(line)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function tokenize(line) {
  var token = {
    line  : line,
    type  : null,
    target: null,
    args  : null
  };

  var blockStartMatch = /^(\s*)&#x3c;!--\s*htmlbuild:([a-zA-Z]*)(.+?)\s*--&#x3e;/.exec(line);

  if (blockStartMatch !== null) {
    token.type   = tokenTypes.BLOCK_START;
    token.indent = blockStartMatch[1];
    token.target = blockStartMatch[2];
    token.args = blockStartMatch[3] ? blockStartMatch[3].trim().split(&#x27; &#x27;) : null;
  } else if (/&#x3c;!--\s*endbuild\s*--&#x3e;/.test(line)) {
    token.type = tokenTypes.BLOCK_END;
  } else {
    token.type = tokenTypes.LINE;
  }

  return token;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.gulp-htmlbuild.parser.parse" id="apidoc.element.gulp-htmlbuild.parser.parse">
        function <span class="apidocSignatureSpan">gulp-htmlbuild.parser.</span>parse
        <span class="apidocSignatureSpan">(file)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function parse(file) {

  var result = buffer();

  setImmediate(function () {

    function makeError(lineNumber, msg) {
      return new gutil.PluginError(PLUGIN_NAME, msg, {
        showStack: false,
        lineNumber: lineNumber,
        fileName: file.path
      });
    }

    var lines   = String(file.contents).split(&#x27;\n&#x27;),
        tokens  = lines.map(tokenize),
        inBlock = false,
        error   = null;

    var currentBlock = new Block({
      lineNumber: 1
    });

    for (var i = 0; i &#x3c; tokens.length; i++) {
      var lineNumber = i + 1,
          token      = tokens[i];

      if (token.type === tokenTypes.BLOCK_START) {
        if (inBlock) {
          error = makeError(lineNumber, &#x27;Blocks can\&#x27;t be nested&#x27;);
          return result.emit(&#x27;error&#x27;, error);
        } else {
          inBlock = true;
        }
      }

      if (token.type === tokenTypes.BLOCK_END) {
        if (inBlock) {
          inBlock = false;
        } else {
          error = makeError(lineNumber, &#x27;Block has no start&#x27;);
          return result.emit(&#x27;error&#x27;, error);
        }
      }

      var switchBlocks = (
        token.type === tokenTypes.BLOCK_START ||
        token.type === tokenTypes.BLOCK_END
      );

      if (switchBlocks) {
        result.write(currentBlock);
        currentBlock = new Block({
          line      : token.line,
          target    : token.target,
          indent    : token.indent,
          args      : token.args,
          lineNumber: lineNumber
        });
      } else {
        currentBlock.lines.push(token.line);
      }
    }

    if (inBlock) {
      error = makeError(currentBlock.lineNumber, &#x27;Unclosed block&#x27;);
      return result.emit(&#x27;error&#x27;, error);
    }

    result.end(currentBlock);
  });

  return result;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.gulp-htmlbuild.preprocess" id="apidoc.module.gulp-htmlbuild.preprocess">module gulp-htmlbuild.preprocess</a></h1>


    <h2>
        <a href="#apidoc.element.gulp-htmlbuild.preprocess.css" id="apidoc.element.gulp-htmlbuild.preprocess.css">
        function <span class="apidocSignatureSpan">gulp-htmlbuild.preprocess.</span>css
        <span class="apidocSignatureSpan">(buildFn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">css = function (buildFn) {

  function extractCss(line) {
    var matched = /(\s*)&#x3c;link.+href=[&#x27;&#x22;]([^&#x22;&#x27;]+)[&#x22;&#x27;]/.exec(line);
    if (matched) {
      return preprocessUtil.pathFromUrl(matched[2]);
    }
  }

  return function (block) {

    function templateCss(path) {
      var template = block.indent + &#x27;&#x3c;link rel=&#x22;stylesheet&#x22; href=&#x22;%s&#x22;/&#x3e;&#x27;;
      return util.format(template, path);
    }


    var extractCssStream = es.mapSync(extractCss),
        templateCssStream = es.mapSync(templateCss);


    block.pipe(extractCssStream);
    templateCssStream.pipe(block);

    buildFn(es.duplex(templateCssStream, extractCssStream));
  };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

a preprocessor you can use to wrap your buildfunction in. It extracts script paths from the block. In this case you also write paths
 to the block. They will get templated into link elements.

#### buildFn

a function that has the same form as a normal buildfunction, only the argument here is a stream that contains script paths. You
are expected to write script paths to this stream as well.

### htmlbuild.preprocess.<span class="apidocCodeKeywordSpan">css</span>(buildFn)

a preprocessor you can use to wrap your buildfunction in. It extracts stylesheet paths from the block. In this case you also write
 paths to the block. They will get templated into link elements.

#### buildFn

a function that has the same form as a normal buildfunction, only the argument here is a stream that contains stylesheet paths.
You are expected to write paths to this stream as well.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.gulp-htmlbuild.preprocess.js" id="apidoc.element.gulp-htmlbuild.preprocess.js">
        function <span class="apidocSignatureSpan">gulp-htmlbuild.preprocess.</span>js
        <span class="apidocSignatureSpan">(buildFn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">js = function (buildFn) {

  function extractScript(line) {
    var matched = /(\s*)&#x3c;script.+src=[&#x27;&#x22;]([^&#x22;&#x27;]+)[&#x22;&#x27;]/.exec(line);
    if (matched) {
      return preprocessUtil.pathFromUrl(matched[2]);
    }
  }

  return function (block) {

    function templateScript(path) {
      var template = block.indent + &#x27;&#x3c;script src=&#x22;%s&#x22;&#x3e;&#x3c;/script&#x3e;&#x27;;
      return util.format(template, path);
    }


    var extractSrc = es.mapSync(extractScript),
        templateSrc = es.mapSync(templateScript);


    block.pipe(extractSrc);
    templateSrc.pipe(block);

    buildFn(es.duplex(templateSrc, extractSrc));
  };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...


```js
gulp.task(&#x27;build&#x27;, function () {
gulp.src([&#x27;./index.html&#x27;])
  .pipe(htmlbuild({
    // build js with preprocessor
    js: htmlbuild.preprocess.<span class="apidocCodeKeywordSpan">js</span>(function (block) {

      // read paths from the [block] stream and build them
      // ...

      // then write the build result path to it
      block.write(&#x27;buildresult.js&#x27;);
      block.end();
...</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
